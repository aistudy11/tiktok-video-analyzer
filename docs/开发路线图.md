# 开发路线图

> **这是唯一的开发执行入口。** 按此文档顺序执行，其他文档仅作参考。

---

## ⚠️ 开发规则（最高优先级）

### 必须遵循的规则文件

开发前必须阅读并遵循 `.claude/rules/` 下的规则：

| 规则文件 | 说明 | 重要程度 |
|----------|------|----------|
| `shipany-base.md` | ShipAny 基座保护规则 | **最高** |
| `00-philosophy.md` | 核心开发哲学 | 高 |
| `deployment.md` | 部署规范（Docker/Dokploy） | 高 |
| `git-safety.md` | Git 安全规则 | 中 |

### 基座保护规则摘要

**核心原则**：基座代码禁止修改，业务代码在指定位置开发。

#### 禁止修改的目录（基座）

```
frontend/src/
├── core/                    # 核心模块 ❌
├── shared/components/ui/    # UI 组件库 ❌
├── shared/blocks/common/    # 通用区块 ❌
├── extensions/              # 扩展模块 ❌
├── app/api/payment/         # 支付 API ❌
├── app/api/user/            # 用户 API ❌
└── themes/default/layouts/  # 布局组件 ❌
```

#### 允许修改的目录（业务）

```
frontend/src/
├── app/api/tiktok/                    # TikTok API ✅
├── themes/default/blocks/tiktok/      # TikTok 组件 ✅
├── shared/hooks/use-tiktok-*.ts       # TikTok hooks ✅
├── shared/hooks/use-script-*.ts       # 脚本 hooks ✅
├── types/tiktok.ts                    # 类型定义 ✅
└── app/[locale]/(landing)/tiktok-*/   # TikTok 页面 ✅

backend/                                # 后端代码 ✅
├── gateway/
└── skills/
```

#### 新增文件位置规范

| 文件类型 | 位置 |
|----------|------|
| 页面 | `app/[locale]/(landing)/[业务名]/` |
| API | `app/api/[业务名]/` |
| 组件 | `themes/default/blocks/[业务名]/` |
| Hooks | `shared/hooks/use-[业务名]-*.ts` |
| 类型 | `types/[业务名].ts` |

---

## 文档体系说明

| 文档 | 定位 | 你需要看吗？ |
|------|------|-------------|
| **开发路线图.md**（本文档） | 执行入口，todolist | **必看，唯一入口** |
| 视频脚本生成功能设计.md | 功能详细设计、Prompt模板 | 开发时参考 |
| 设计实施规范.md | UI/UX规范、主题样式 | 做前端UI时参考 |
| 产品需求与UI设计简报.md | 产品定位、页面结构 | 了解产品背景时参考 |

---

## 当前状态

**已完成：**
- [x] 项目基础架构（ShipAny2 底座）
- [x] TikTok 视频下载
- [x] AI 视频内容分析
- [x] 飞书多维表格同步
- [x] Notion 数据库同步
- [x] 后端 API 部署（Dokploy）

**待开发：**
- [ ] 视频脚本生成功能
- [ ] 前端页面完善

---

## 开发阶段

### 阶段一：视频脚本生成功能 ⬅️ 当前阶段

**目标**：基于视频分析结果，生成可执行的制作脚本

**参考文档**：`视频脚本生成功能设计.md`

#### 后端任务（在 `backend/skills/` 下开发）

| # | 任务 | 文件位置 | 状态 |
|---|------|----------|------|
| 1.1 | 创建 script_generator 模块 | `backend/skills/script_generator/` | ✅ |
| 1.2 | 实现 Prompt 模板 | `backend/skills/script_generator/prompts/` | ✅ |
| 1.3 | 实现脚本生成逻辑 | `backend/skills/script_generator/generator.py` | ✅ |
| 1.4 | 新增 generate-script API | `backend/gateway/main.py` | ✅ |
| 1.5 | 新增 get-script API | `backend/gateway/main.py` | ✅ |
| 1.6 | 测试验收 | - | ✅ |

#### 前端任务（在业务目录下开发）

| # | 任务 | 文件位置 | 状态 |
|---|------|----------|------|
| 1.7 | 脚本查看组件 | `themes/default/blocks/tiktok/script-viewer.tsx` | ✅ |
| 1.8 | 分镜头表格组件 | `themes/default/blocks/tiktok/storyboard-table.tsx` | ✅ |
| 1.9 | 调用脚本生成 API | `shared/hooks/use-production-script.ts` | ✅ |

---

### 阶段二：UI 主题完善

**参考文档**：`设计实施规范.md`

| # | 任务 | 文件位置 | 状态 |
|---|------|----------|------|
| 2.1 | BackgroundLayer 组件 | `themes/default/blocks/tiktok/background-layer.tsx` | ⬜ |
| 2.2 | GlassPanel 组件 | `themes/default/blocks/tiktok/glass-panel.tsx` | ⬜ |
| 2.3 | 主题 CSS 变量 | `config/style/theme.css` | ⬜ |

---

### 阶段三：多平台支持（未来）

| # | 任务 | 状态 |
|---|------|------|
| 3.1 | YouTube 视频分析 | ⬜ 规划中 |
| 3.2 | Instagram 视频分析 | ⬜ 规划中 |

---

## 执行检查清单

每次开发前确认：

- [ ] 要修改的文件是否在**业务目录**内？
- [ ] 是否遵循了文件位置规范？
- [ ] 是否阅读了对应的参考文档？

---

## 快速链接

- [视频脚本生成功能设计](./视频脚本生成功能设计.md)
- [设计实施规范](./设计实施规范.md)
- [ShipAny 基座规则](../.claude/rules/shipany-base.md)

---

*最后更新：2025-02-02*
